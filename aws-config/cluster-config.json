{
    "Name": "p11-fruits-soutenance",
    "ReleaseLabel": "emr-6.15.0",
    "Applications": [
        {"Name": "Spark"},
        {"Name": "Zeppelin"}
    ],
    "Configurations": [
        {
            "Classification": "spark-defaults",
            "Properties": {
                "spark.sql.adaptive.enabled": "true",
                "spark.sql.adaptive.coalescePartitions.enabled": "true",
                "spark.sql.execution.arrow.pyspark.enabled": "true",
                "spark.executor.memory": "3g",
                "spark.driver.memory": "2g",
                "spark.executor.memoryFraction": "0.8",
                "spark.sql.shuffle.partitions": "100",
                "spark.serializer": "org.apache.spark.serializer.KryoSerializer",
                "spark.hadoop.fs.s3a.impl": "org.apache.hadoop.fs.s3a.S3AFileSystem",
                "spark.hadoop.fs.s3a.aws.credentials.provider": "com.amazonaws.auth.InstanceProfileCredentialsProvider"
            }
        }
    ],
    "Instances": {
        "MasterInstanceGroup": {
            "InstanceType": "m5.large",
            "InstanceCount": 1,
            "Market": "SPOT",
            "BidPrice": "0.15"
        },
        "CoreInstanceGroup": {
            "InstanceType": "m5.large", 
            "InstanceCount": 1,
            "Market": "SPOT",
            "BidPrice": "0.15"
        },
        "Ec2KeyName": "p11-keypair",
        "KeepJobFlowAliveWhenNoSteps": true,
        "TerminationProtected": false
    },
    "BootstrapActions": [
        {
            "Name": "Install-Python-Packages",
            "ScriptBootstrapAction": {
                "Path": "s3://fruits-p11-production/bootstrap/bootstrap-emr-optimized.sh"
            }
        }
    ],
    "ServiceRole": "EMR_DefaultRole",
    "JobFlowRole": "EMR_EC2_DefaultRole",
    "VisibleToAllUsers": true,
    "LogUri": "s3n://fruits-p11-production/logs/",
    "Tags": [
        {"Key": "Project", "Value": "P11-Fruits"},
        {"Key": "Environment", "Value": "Demo"},
        {"Key": "Auto-Stop", "Value": "4h"}
    ]
}
